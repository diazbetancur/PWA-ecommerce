<div class="modal-header">
  <h2 mat-dialog-title>Productos de "{{ data.categoryName }}"</h2>
  <app-button
    variant="ghost"
    icon="close"
    size="sm"
    (clicked)="close()"
  ></app-button>
</div>

<mat-dialog-content>
  @if (loading()) {
  <div class="loading-container">
    <mat-spinner diameter="40"></mat-spinner>
    <p>Cargando productos...</p>
  </div>
  } @else if (products().length > 0) {
  <div class="table-container">
    <table mat-table [dataSource]="products()" class="products-table">
      <!-- Nombre -->
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>Nombre</th>
        <td mat-cell *matCellDef="let product">
          <strong>{{ product.name }}</strong>
        </td>
      </ng-container>

      <!-- SKU -->
      <ng-container matColumnDef="sku">
        <th mat-header-cell *matHeaderCellDef>SKU</th>
        <td mat-cell *matCellDef="let product">
          <code>{{ product.sku || 'N/A' }}</code>
        </td>
      </ng-container>

      <!-- Precio -->
      <ng-container matColumnDef="price">
        <th mat-header-cell *matHeaderCellDef>Precio</th>
        <td mat-cell *matCellDef="let product">
          {{ formatPrice(product.price) }}
        </td>
      </ng-container>

      <!-- Stock -->
      <ng-container matColumnDef="stock">
        <th mat-header-cell *matHeaderCellDef>Stock</th>
        <td mat-cell *matCellDef="let product">
          <span [class.low-stock]="product.stock < 10">
            {{ product.stock }}
          </span>
        </td>
      </ng-container>

      <!-- Estado -->
      <ng-container matColumnDef="active">
        <th mat-header-cell *matHeaderCellDef>Estado</th>
        <td mat-cell *matCellDef="let product">
          @if (product.isActive) {
          <span class="status-badge active">Activo</span>
          } @else {
          <span class="status-badge inactive">Inactivo</span>
          }
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
  </div>

  <mat-paginator
    [length]="totalCount()"
    [pageSize]="pageSize()"
    [pageIndex]="page() - 1"
    [pageSizeOptions]="pageSizeOptions"
    (page)="onPageChange($event)"
    showFirstLastButtons
  >
  </mat-paginator>
  } @else {
  <div class="empty-state">
    <mat-icon>inventory_2</mat-icon>
    <p>Esta categor√≠a no tiene productos asociados</p>
  </div>
  }
</mat-dialog-content>
