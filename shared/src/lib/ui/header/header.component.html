<header class="header" [class.menu-open]="isMobileMenuOpen()">
  <div class="header-container">
    <!-- Logo -->
    <a routerLink="/" class="logo">
      @if (logoUrl(); as logo) {
      <img [src]="logo" [alt]="displayName()" class="logo-img" />
      } @else {
      <span class="logo-text">{{ displayName() }}</span>
      }
    </a>

    <!-- Desktop Navigation -->
    <nav class="nav-desktop">
      <a
        routerLink="/"
        routerLinkActive="active"
        [routerLinkActiveOptions]="{ exact: true }"
        >Inicio</a
      >
      <a routerLink="/catalog" routerLinkActive="active">Productos</a>
    </nav>

    <!-- Actions -->
    <div class="header-actions">
      <!-- Cart -->
      <a routerLink="/cart" class="action-btn cart-btn" aria-label="Carrito">
        <svg
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <path
            d="M9 22a1 1 0 100-2 1 1 0 000 2zM20 22a1 1 0 100-2 1 1 0 000 2zM1 1h4l2.68 13.39a2 2 0 002 1.61h9.72a2 2 0 002-1.61L23 6H6"
          />
        </svg>
        @if (cartCount() > 0) {
        <span class="cart-badge">{{ cartCount() }}</span>
        }
      </a>

      <!-- User -->
      @if (isAuthenticated()) {
      <div class="user-menu-wrapper">
        <button
          class="action-btn user-btn"
          (click)="toggleUserMenu()"
          aria-label="Mi cuenta"
        >
          <svg
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2" />
            <circle cx="12" cy="7" r="4" />
          </svg>
        </button>
        @if (isUserMenuOpen()) {
        <div class="user-dropdown" (click)="closeUserMenu()">
          <a routerLink="/account/profile">Mi Perfil</a>
          <a routerLink="/orders">Mis Pedidos</a>
          <button class="logout-btn" (click)="logout()">Cerrar Sesión</button>
        </div>
        }
      </div>
      } @else {
      <a routerLink="/account/login" class="action-btn login-btn">
        <svg
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2" />
          <circle cx="12" cy="7" r="4" />
        </svg>
        <span class="login-text">Ingresar</span>
      </a>
      }

      <!-- Mobile Menu Toggle -->
      <button
        class="menu-toggle"
        (click)="toggleMobileMenu()"
        aria-label="Menú"
      >
        <span class="menu-line"></span>
        <span class="menu-line"></span>
        <span class="menu-line"></span>
      </button>
    </div>
  </div>

  <!-- Mobile Navigation -->
  @if (isMobileMenuOpen()) {
  <nav class="nav-mobile">
    <a
      routerLink="/"
      (click)="closeMobileMenu()"
      routerLinkActive="active"
      [routerLinkActiveOptions]="{ exact: true }"
    >
      <svg
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
      >
        <path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z" />
      </svg>
      Inicio
    </a>
    <a
      routerLink="/catalog"
      (click)="closeMobileMenu()"
      routerLinkActive="active"
    >
      <svg
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
      >
        <rect x="3" y="3" width="7" height="7" />
        <rect x="14" y="3" width="7" height="7" />
        <rect x="14" y="14" width="7" height="7" />
        <rect x="3" y="14" width="7" height="7" />
      </svg>
      Productos
    </a>
    <a routerLink="/cart" (click)="closeMobileMenu()" routerLinkActive="active">
      <svg
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
      >
        <path
          d="M9 22a1 1 0 100-2 1 1 0 000 2zM20 22a1 1 0 100-2 1 1 0 000 2zM1 1h4l2.68 13.39a2 2 0 002 1.61h9.72a2 2 0 002-1.61L23 6H6"
        />
      </svg>
      Carrito @if (cartCount() > 0) {
      <span class="mobile-badge">{{ cartCount() }}</span>
      }
    </a>
    @if (isAuthenticated()) {
    <a routerLink="/account/profile" (click)="closeMobileMenu()">
      <svg
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
      >
        <path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2" />
        <circle cx="12" cy="7" r="4" />
      </svg>
      Mi Cuenta
    </a>
    <button class="mobile-logout" (click)="logout(); closeMobileMenu()">
      <svg
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
      >
        <path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4M16 17l5-5-5-5M21 12H9" />
      </svg>
      Cerrar Sesión
    </button>
    } @else {
    <a
      routerLink="/account/login"
      (click)="closeMobileMenu()"
      class="mobile-login"
    >
      <svg
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
      >
        <path
          d="M15 3h4a2 2 0 012 2v14a2 2 0 01-2 2h-4M10 17l5-5-5-5M15 12H3"
        />
      </svg>
      Ingresar
    </a>
    }
  </nav>
  }
</header>
