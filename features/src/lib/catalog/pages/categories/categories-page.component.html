<div class="categories-page">
  <!-- Search Bar -->
  <div class="search-container">
    <div class="search-wrapper">
      <svg
        class="search-icon"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
      >
        <circle cx="11" cy="11" r="8" />
        <path d="M21 21l-4.35-4.35" />
      </svg>
      <input
        [formControl]="searchControl"
        type="text"
        placeholder="Buscar categorías..."
        class="search-input"
      />
      @if (searchControl.value) {
      <button
        class="clear-search"
        (click)="clearSearch()"
        aria-label="Limpiar búsqueda"
      >
        <svg
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <line x1="18" y1="6" x2="6" y2="18" />
          <line x1="6" y1="6" x2="18" y2="18" />
        </svg>
      </button>
      }
    </div>
  </div>

  <!-- Loading State -->
  @if (loading()) {
  <div class="loading-container">
    <div class="skeleton-grid">
      @for (item of [1, 2, 3, 4, 5, 6]; track item) {
      <div class="skeleton-card">
        <div class="skeleton-image"></div>
        <div class="skeleton-content">
          <div class="skeleton-title"></div>
          <div class="skeleton-text"></div>
        </div>
      </div>
      }
    </div>
  </div>
  }

  <!-- Categories Grid -->
  @if (!loading() && displayedCategories().length > 0) {
  <div class="categories-grid">
    @for (category of displayedCategories(); track category.id) {
    <button
      class="category-card"
      (click)="goToCategory(category.slug)"
      [title]="category.name"
    >
      <div class="category-image-wrapper">
        @if (category.imageUrl) {
        <img
          [src]="category.imageUrl"
          [alt]="category.name + ' - ' + category.productCount + ' productos'"
          [title]="category.name"
          class="category-image"
          loading="lazy"
        />
        } @else {
        <div class="category-placeholder">
          <svg class="placeholder-icon" viewBox="0 0 24 24" fill="currentColor">
            <path
              d="M10 3H4a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1zM9 9H5V5h4v4zm11-6h-6a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1zm-1 6h-4V5h4v4zm-9 4H4a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-6a1 1 0 0 0-1-1zm-1 6H5v-4h4v4zm11-6h-6a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-6a1 1 0 0 0-1-1zm-1 6h-4v-4h4v4z"
            />
          </svg>
        </div>
        }
      </div>
      <div class="category-content">
        <h3 class="category-name">{{ category.name }}</h3>
        <p class="category-count">{{ category.productCount }} productos</p>
      </div>
    </button>
    }
  </div>

  <!-- Loading More Indicator -->
  @if (loadingMore()) {
  <div class="loading-more">
    <div class="spinner"></div>
    <p>Cargando más categorías...</p>
  </div>
  } }

  <!-- Empty State -->
  @if (!loading() && displayedCategories().length === 0) {
  <div class="empty-state">
    <svg
      class="empty-icon"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="2"
    >
      <rect x="3" y="3" width="7" height="7" />
      <rect x="14" y="3" width="7" height="7" />
      <rect x="14" y="14" width="7" height="7" />
      <rect x="3" y="14" width="7" height="7" />
    </svg>
    @if (searchControl.value) {
    <h3>No se encontraron categorías</h3>
    <p>Intenta con otros términos de búsqueda</p>
    <button class="retry-btn" (click)="clearSearch()">Limpiar búsqueda</button>
    } @else {
    <h3>No hay categorías disponibles</h3>
    <p>No hay categorías disponibles en este momento</p>
    }
  </div>
  }
</div>
