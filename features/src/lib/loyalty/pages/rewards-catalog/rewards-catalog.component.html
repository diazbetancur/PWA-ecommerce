<div class="rewards-catalog-page">
  <!-- Header -->
  <div class="page-header">
    <h1>üéÅ Cat√°logo de Premios</h1>
    <p>Canjea tus puntos por productos y descuentos exclusivos</p>
  </div>

  <!-- Filters -->
  <div class="filters-section">
    <div class="filter-group">
      <label for="rewardType">Tipo de Premio:</label>
      <select
        id="rewardType"
        [(ngModel)]="selectedType"
        (change)="onFilterChange()"
        class="form-select"
      >
        <option value="">Todos</option>
        <option value="PRODUCT">Productos</option>
        <option value="DISCOUNT_PERCENTAGE">Descuentos %</option>
        <option value="DISCOUNT_FIXED">Descuentos Fijos</option>
        <option value="FREE_SHIPPING">Env√≠o Gratis</option>
      </select>
    </div>

    <div class="filter-group">
      <label for="sortBy">Ordenar por:</label>
      <select
        id="sortBy"
        [(ngModel)]="sortBy"
        (change)="sortRewards()"
        class="form-select"
      >
        <option value="points-asc">Puntos: Menor a Mayor</option>
        <option value="points-desc">Puntos: Mayor a Menor</option>
        <option value="name-asc">Nombre: A-Z</option>
        <option value="name-desc">Nombre: Z-A</option>
      </select>
    </div>
  </div>

  <!-- Loading State -->
  @if (isLoading()) {
  <div class="loading-container">
    <div class="spinner"></div>
    <p>Cargando premios...</p>
  </div>
  }

  <!-- Error State -->
  @if (error()) {
  <div class="alert alert-danger"><strong>Error:</strong> {{ error() }}</div>
  }

  <!-- Rewards Grid -->
  @if (!isLoading() && displayedRewards().length > 0) {
  <div class="rewards-grid">
    @for (reward of displayedRewards(); track reward.id) {
    <div class="reward-card" [class.out-of-stock]="isOutOfStock(reward)">
      <!-- Image -->
      <div class="reward-image">
        @if (reward.imageUrl) {
        <img [src]="reward.imageUrl" [alt]="reward.name" />
        } @else {
        <div class="placeholder-image">
          {{ getRewardIcon(reward.rewardType) }}
        </div>
        }

        <!-- Stock Badge -->
        @if (isOutOfStock(reward)) {
        <div class="stock-badge out">Agotado</div>
        } @else if (isLowStock(reward)) {
        <div class="stock-badge low">¬°√öltimas unidades!</div>
        }

        <!-- Type Badge -->
        <div class="type-badge">
          {{ getRewardTypeLabel(reward.rewardType) }}
        </div>
      </div>

      <!-- Content -->
      <div class="reward-content">
        <h3 class="reward-name">{{ reward.name }}</h3>
        <p class="reward-description">{{ reward.description }}</p>

        <!-- Reward Value -->
        @if (reward.discountValue) {
        <div class="reward-value">
          <span class="value-icon">üí∞</span>
          <span class="value-text">
            @if (reward.rewardType === 'DISCOUNT_PERCENTAGE') {
            {{ reward.discountValue }}% de descuento } @else {
            {{ reward.discountValue | currency : 'USD' : 'symbol' : '1.2-2' }}
            de descuento }
          </span>
        </div>
        }

        <!-- Points Cost -->
        <div class="points-cost">
          <span class="icon">üíé</span>
          <span class="cost">{{ reward.pointsCost | number : '1.0-0' }}</span>
          <span class="label">puntos</span>
        </div>

        <!-- Action Button -->
        <button
          class="redeem-btn"
          [disabled]="isOutOfStock(reward)"
          (click)="redeemReward(reward)"
        >
          @if (isOutOfStock(reward)) { Agotado } @else { Canjear Ahora }
        </button>

        <!-- Validity Info -->
        @if (reward.validityDays) {
        <div class="validity-info">
          ‚è∞ V√°lido por {{ reward.validityDays }} d√≠as
        </div>
        }
      </div>
    </div>
    }
  </div>

  <!-- Pagination -->
  @if (totalPages() > 1) {
  <div class="pagination">
    <button
      class="page-btn"
      [disabled]="currentPage() === 1"
      (click)="goToPage(currentPage() - 1)"
    >
      ‚Üê Anterior
    </button>

    <span class="page-info">
      P√°gina {{ currentPage() }} de {{ totalPages() }}
    </span>

    <button
      class="page-btn"
      [disabled]="currentPage() === totalPages()"
      (click)="goToPage(currentPage() + 1)"
    >
      Siguiente ‚Üí
    </button>
  </div>
  } }

  <!-- Empty State -->
  @if (!isLoading() && displayedRewards().length === 0) {
  <div class="empty-state">
    <div class="empty-icon">üéÅ</div>
    <h3>No hay premios disponibles</h3>
    <p>Vuelve pronto para ver nuevos premios en el cat√°logo</p>
  </div>
  }
</div>
